<?xml version="1.0" encoding="utf-8" ?>

<cdsl>
    <flow id="test-flow-a" defaultStep="init" errorStep="error">
        <flowStep id="init">
            <sayHello name="fred"/>
            <dslWithComplexModel aModelProperty="testProperty">
                <modelChild>
                    <name>testChildName</name>
                    <aList>
                        <entry>firstValue</entry>
                        <entry>secondValue</entry>
                    </aList>
                </modelChild>
            </dslWithComplexModel>
        </flowStep>

    </flow>

    <flow id="shouldRunHelloWorldAndEndRoute" defaultStep="init" errorStep="error">
        <flowStep id="init">
            <setState val="Alive"/>
            <sayHello name="fred"/>
            <setVar name="myVar" val="myVal"/>
            <routeTo target="end"/>
        </flowStep>

        <flowStep id="end">
            <endRoute/>
            <finally>
                <setState val="End"/>
            </finally>
        </flowStep>
    </flow>

    <flow id="shouldRaiseExceptionFlow" defaultStep="init" errorStep="error">

        <flowStep id="init">
            <setState val="Alive"/>
            <raiseException/>
        </flowStep>

        <flowStep id="error">
            <setVar name="errorRaised" val="yesItWas"/>
            <finally>
                <endRoute/>
                <setState val="Error"/>
            </finally>
        </flowStep>

        <flowStep id="end">
            <endRoute/>
            <finally>
                <setState val="End"/>
            </finally>
        </flowStep>
    </flow>


    <flow id="shouldRouteThroughAThenBThenAwaitAtC" defaultStep="init" errorStep="error">
        <flowStep id="init">
            <setState val="Alive"/>
            <routeTo target="a"/>
        </flowStep>

        <flowStep id="a">
            <routeTo target="b"/>
        </flowStep>

        <flowStep id="b">
            <await at="c"/>
        </flowStep>

        <flowStep id="c" >
            <whiteList onFailure="Reject" names="message, other" />
            <routeTo target="end"/>
        </flowStep>

        <flowStep id="end">
            <endRoute/>
            <finally>
                <setState val="End"/>
            </finally>
        </flowStep>
    </flow>

    <flow id="shouldAwaitAtB" defaultStep="init" errorStep="error">
        <flowStep id="init">
            <setState val="Alive"/>
            <routeTo target="a"/>
        </flowStep>

        <flowStep id="a">
            <await at="b"/>
        </flowStep>

        <flowStep id="b">
            <whiteList names="message" onFailure="Route" to="end"/>
        </flowStep>

        <flowStep id="end">
            <endRoute/>
            <finally>
                <setState val="End"/>
            </finally>
        </flowStep>
    </flow>


    <flow id="shouldProcessInputModelA" defaultStep="init" errorStep="error">
        <flowStep id="init">
            <setState val="Alive"/>
            <routeTo target="reverseInputModel"/>
        </flowStep>

        <flowStep id="reverseInputModel">
            <reverseCustomInput outVar="myChosenVar"/>
            <routeTo target="end"/>
        </flowStep>

        <flowStep id="end">
            <endRoute/>
            <finally>
                <setState val="End"/>
                <!--<outCome varName="myChosenVar"/>-->
            </finally>
        </flowStep>
    </flow>


    <flow id="shouldRunInjected" defaultStep="init" >
        <flowStep id="init">
            <injected name="injectedOne"/>
            <routeTo target="end"/>
        </flowStep>

        <flowStep id="end">
            <endRoute/>
            <finally>
                <setState val="End"/>
            </finally>
        </flowStep>
    </flow>

</cdsl>